import{K as b,r as t,j as e,L as T,a as A}from"./app-CssLvUIy.js";import{D as L}from"./app-datatable-BeJRJFo1.js";import{B as m}from"./button-C4WyL6s5.js";import{D as U,a as B,b as O,c as z,d as G,e as K,f as g}from"./dialog-B3IU8IIQ.js";import{L as d,I as l}from"./label-BtSorOQx.js";import{T as M}from"./textarea-5FjPn5Vr.js";import{A as H}from"./app-layout-Bo3Mcdu3.js";import{d as J}from"./index-Co1wP1WO.js";import{S as Q,a as V}from"./react-select.esm-CN7fUWm-.js";import W from"./approver-table-Du-pYBkg.js";import"./plus-DvW-7UEB.js";import"./createLucideIcon-B__Mbpjy.js";import"./index-DYw4DpLt.js";import"./index-CJpG0XJO.js";const X=[{title:"Purchase Requisition",href:"/prpo/purchase-request"}];function he(){const{classification:N}=b().props,v=b(),{auth:a}=v.props,w=new Date().toISOString().split("T")[0],[r,o]=t.useState({date_needed:!1,prod_end_user:!1,classification_id:!1}),[x,y]=t.useState(""),[p,Y]=t.useState(w),[n,S]=t.useState(""),[c,C]=t.useState(""),[u,D]=t.useState(),[h,k]=t.useState(""),[Z,ee]=t.useState(""),[f,R]=t.useState(0),[_,$]=t.useState([]),[q,F]=t.useState(),j=N.map(s=>({value:s.id,label:s.name,it_related:s.it_related})),I=async s=>{s.preventDefault();const i={date_needed:!n,prod_end_user:!c,classification_id:!u};if(o(i),Object.values(i).some(Boolean))return;F(!0);const P={pr_no:x,requestor_id:a.user.id,date_issue:p,date_needed:n,bu_id:a.user.bu_id,department_id:a.user.dept_id,prod_end_user:c,classification_id:u,is_it_related:f,im_supervisor_id:a.user.immediate_head_id,remarks:h,items:_};try{const E=await A.post("/prpo/purchase-request",P);J.Inertia.visit("/prpo/purchase-request")}catch{}};return e.jsx("div",{className:"flex h-screen flex-col",children:e.jsxs(H,{breadcrumbs:X,children:[e.jsx(T,{title:"Create PR"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 px-4",children:[e.jsxs("div",{className:"mt-2 flex w-full justify-end gap-4 rounded border bg-white px-6 py-4 shadow",children:[e.jsx("div",{className:"flex-1 justify-start",children:e.jsx("img",{src:a.user.bu_id==1?`${window.location.origin}/storage/suhay_logo.png`:a.user.bu_id==2?`${window.location.origin}/storage/alibata_logo.png`:"",alt:"",style:{width:"150px",objectFit:"contain"}})}),e.jsxs("div",{className:"max-w-sm flex-1",children:[e.jsx(d,{htmlFor:"pr_no",className:`mb-1 block font-bold text-gray-500 ${r.pr_no?"text-red-500":""}`,children:"PR No."}),e.jsx(l,{id:"pr_no",type:"text",name:"pr_no",className:"w-full rounded-sm shadow-none",value:x,placeholder:"--Auto Generated--",onChange:s=>{y(s.target.value),o(i=>({...i,pr_no:!1}))},readOnly:!0})]})]}),e.jsxs("div",{className:"rounded border bg-white p-4 shadow",children:[e.jsxs("div",{className:"flex w-full gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{htmlFor:"requestor_id",className:"mb-1 block font-bold text-gray-500",children:"Name of Requestor"}),e.jsx(l,{id:"requestor_id",type:"text",name:"requestor_id",className:"w-full rounded-sm shadow-none",value:`${a.user.fname} ${a.user.mname??""} ${a.user.lname}`,placeholder:"Name of Requestor",readOnly:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{htmlFor:"date_issue",className:"mb-1 block font-bold text-gray-500",children:"Date Issue"}),e.jsx(l,{id:"date_issue",type:"date",name:"date_issue",className:"w-full rounded-sm shadow-none",value:p,readOnly:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{htmlFor:"date_needed",className:`mb-1 block font-bold text-gray-500 ${r.date_needed?"text-red-500":""}`,children:"Date Needed"}),e.jsx(l,{id:"date_needed",type:"date",name:"date_needed",className:`w-full rounded-sm shadow-none ${r.date_needed?"border-red-500":""}`,value:n,min:new Date().toISOString().split("T")[0],onChange:s=>{S(s.target.value),o({...r,date_needed:!1})}})]})]}),e.jsxs("div",{className:"mt-4 flex w-full gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{htmlFor:"bu_id",className:"mb-1 block font-bold text-gray-500",children:"Business Unit"}),e.jsx(l,{id:"bu_id",type:"text",name:"bu_id",className:"w-full rounded-sm shadow-none",value:a.user.business_unit.name,readOnly:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{htmlFor:"department_id",className:"mb-1 block font-bold text-gray-500",children:"Department"}),e.jsx(l,{id:"department_id",type:"text",name:"department_id",className:"w-full rounded-sm shadow-none",value:a.user.department.name,readOnly:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{htmlFor:"prod_end_user",className:`mb-1 block font-bold text-gray-500 ${r.prod_end_user?"text-red-500":""}`,children:"Product End User"}),e.jsx(l,{id:"prod_end_user",type:"text",name:"prod_end_user",className:`w-full rounded-sm shadow-none ${r.prod_end_user?"border-red-500":""}`,value:c??"",placeholder:"Product End User",onChange:s=>{C(s.target.value),o({...r,prod_end_user:!1})}})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{htmlFor:"classification_id",className:`mb-1 block font-bold text-gray-500 ${r.classification_id?"text-red-500":""}`,children:"Classification"}),e.jsx(Q,{id:"classification_id",placeholder:"Select Classification",isClearable:!0,options:j,value:j.find(s=>s.value===u)||null,onChange:s=>{D(s?s.value:void 0),R((s==null?void 0:s.it_related)??0),o({...r,classification_id:!1})},styles:{control:(s,i)=>({...s,borderColor:r.classification_id?"red":""})}})]})]})]}),e.jsx("div",{className:"w-full rounded bg-white shadow",children:e.jsx(L,{items:_,setItems:$,showAddRow:!0})}),e.jsx("div",{className:"flex w-full gap-4 rounded bg-white p-4 shadow",children:e.jsxs("div",{className:"flex-1",children:[e.jsx(d,{htmlFor:"remarks",className:"mb-1 block font-bold text-gray-500",children:"Remarks"}),e.jsx(M,{id:"remarks",name:"remarks",className:"rounded-sm shadow-none",value:h,placeholder:"Remarks",onChange:s=>{k(s.target.value)}})]})}),e.jsx(W,{itRelated:f}),e.jsx("div",{className:"flex flex-col items-center justify-center gap-4 p-4",children:e.jsx("div",{className:"flex flex-col gap-2 md:flex-row md:items-center",children:e.jsxs(U,{children:[e.jsx(B,{asChild:!0,children:e.jsxs(m,{type:"submit",disabled:!n||!c||!u,children:[e.jsx(V,{className:"mr-1 h-4 w-4"}),"Submit"]})}),e.jsxs(O,{className:"z-99999",children:[e.jsx(z,{children:"Purchase Request"}),e.jsx(G,{children:"Are you sure you want to proceed?"}),e.jsxs(K,{className:"gap-2",children:[e.jsx(g,{asChild:!0,children:e.jsx(m,{variant:"secondary",children:"Cancel"})}),e.jsx(g,{asChild:!0,children:e.jsx(m,{asChild:!0,children:e.jsx("button",{type:"submit",onClick:I,children:q?"Please wait.":"Confirm"})})})]})]})]})})})]})]})})}export{he as default};
