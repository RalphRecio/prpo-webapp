import{r as t,j as e,a as z,K as U,L as ne}from"./app-CssLvUIy.js";import{B as f}from"./button-C4WyL6s5.js";import{T as _}from"./textarea-5FjPn5Vr.js";import{S as v,a as le}from"./react-select.esm-CN7fUWm-.js";import{P as ie}from"./plus-DvW-7UEB.js";import{T as de,d as oe}from"./index-Co1wP1WO.js";import{D as ce,a as ue,b as me,c as xe,d as pe,e as he,f as B}from"./dialog-B3IU8IIQ.js";import{L as r,I as o}from"./label-BtSorOQx.js";import{A as fe}from"./app-layout-Bo3Mcdu3.js";import ge from"./po-approver-table-DQywHIpW.js";import"./createLucideIcon-B__Mbpjy.js";import"./index-DYw4DpLt.js";import"./index-CJpG0XJO.js";function je({variant:F="header",items:l,setItems:g,showAddRow:i,...w}){const[c,j]=t.useState(null),[b,S]=t.useState(""),[n,C]=t.useState({quantity:"",unit_of_measrurement:"",ite_description:"",unit_price:"",extended_price:""}),[y,I]=t.useState(null),[k,G]=t.useState({quantity:"",unit_of_measrurement:"",ite_description:"",unit_price:"",extended_price:""}),m=a=>{const{name:u,value:d}=a.target;C({...n,[u]:d})},[Q,R]=t.useState(0),P=()=>{!n.quantity||!n.unit_of_measrurement||!n.unit_price||!n.extended_price||(g([...l,{...n,id:Date.now(),lineNo:l.length+1,ite_description:b}]),C({quantity:"",unit_of_measrurement:"",ite_description:"",unit_price:"",extended_price:""}))},T=a=>{g(l.filter((u,d)=>d!==a))},N=window.location.pathname.split("/"),E=N[N.length-1],[x,D]=t.useState(),[p,q]=t.useState(void 0),[H,J]=t.useState(null),V=async()=>{try{const u=(await z.get("/prpo/purchase-order/pr-items/"+E)).data.map(d=>({value:d.id,label:d.item_name??`Item ${d.id}`,description:d.description}));D(u)}catch(a){console.error("Error fetching PR items:",a)}};return t.useEffect(()=>{V(),S((p==null?void 0:p.description)||"")},[p]),e.jsx("div",{className:"border",...w,children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium tracking-wider text-gray-900 uppercase",children:"Line"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium tracking-wider text-gray-900 uppercase",children:"Quantity"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium tracking-wider text-gray-900 uppercase",children:"Unit of Measure"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium tracking-wider text-gray-900 uppercase",children:"Item Description"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium tracking-wider text-gray-900 uppercase",children:"Unit Price"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium tracking-wider text-gray-900 uppercase",children:"Extended Price"}),i&&e.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium tracking-wider text-gray-900 uppercase",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200 bg-white text-sm text-gray-500",children:[i&&e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{name:"quantity",type:"number",value:n.quantity,onChange:m,className:"w-full rounded border px-2 py-1 focus:ring-2 focus:ring-blue-400 focus:outline-none",placeholder:"Quantity"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{name:"unit_of_measrurement",value:n.unit_of_measrurement,onChange:m,className:"w-full rounded border px-2 py-1 focus:ring-2 focus:ring-blue-400 focus:outline-none",placeholder:"UOM"})}),e.jsxs("td",{className:"px-4 py-2",children:[e.jsx(v,{id:"item_description",placeholder:"Select Item",isClearable:!0,options:x,value:(x==null?void 0:x.find(a=>a.value===c))||null,onChange:a=>{j((a==null?void 0:a.value)||null),q(a||null)}}),e.jsx(_,{value:b,onChange:a=>S(a.target.value),className:"mt-1"})]}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{name:"unit_price",value:n.unit_price,onChange:m,className:"w-full rounded border px-2 py-1 focus:ring-2 focus:ring-blue-400 focus:outline-none",placeholder:"Status"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{name:"extended_price",value:n.extended_price,onChange:m,className:"w-full rounded border px-2 py-1 focus:ring-2 focus:ring-blue-400 focus:outline-none",placeholder:"Status"})}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx(f,{onClick:P,type:"button",variant:"outline",size:"sm",children:e.jsx(ie,{})})})]}),l.map((a,u)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2 font-bold",children:a.lineNo}),e.jsx("td",{className:"px-4 py-2",children:a.quantity}),e.jsx("td",{className:"px-4 py-2",children:a.unit_of_measrurement}),e.jsx("td",{className:"px-4 py-2",children:a.ite_description}),e.jsx("td",{className:"px-4 py-2",children:a.unit_price}),e.jsx("td",{className:"px-4 py-2",children:a.extended_price}),i&&e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("div",{className:"flex justify-center gap-2",children:e.jsx(f,{onClick:()=>T(u),type:"button",size:"sm",variant:"default",children:e.jsx(de,{})})})})]},a.id))]})]})})}const be=[{title:"Purchase Order",href:"/prpo/purchase-request"}];function Ee(){const{vendorList:F,purchaseRequest:l}=U().props,g=U(),{auth:i}=g.props,w=new Date().toISOString().split("T")[0],[c,j]=t.useState({date_needed:!1,prod_end_user:!1,classification_id:!1}),[b,S]=t.useState(""),[n,C]=t.useState(w),[y,I]=t.useState(""),[k,G]=t.useState(""),[m,Q]=t.useState(),[R,P]=t.useState(""),[T,K]=t.useState(""),[N,E]=t.useState(0),[x,D]=t.useState([]),[p,q]=t.useState(),[H,J]=t.useState(""),[V,a]=t.useState(""),[u,d]=t.useState(""),[W,ye]=t.useState(""),[h,X]=t.useState(),[A,Y]=t.useState(void 0),[Ne,Z]=t.useState(null),ee=async s=>{s.preventDefault();const M={date_needed:!y,prod_end_user:!k,classification_id:!m};if(j(M),Object.values(M).some(Boolean))return;q(!0);const ae={};try{const re=await z.post("/prpo/purchase-request",ae);oe.Inertia.visit("/prpo/purchase-request")}catch{}},[se,te]=t.useState(),O=F.map(s=>({value:s.id,label:s.supplier_name,address:s.address,contact_person:s.contact_person,contact_number:s.contact_number})),$=[{value:"land",label:"Land"},{value:"sea",label:"Sea"},{value:"air",label:"Air"}],L=[{value:"air freight",label:"Air Freight"},{value:"land freight",label:"Land Freight"},{value:"ocean freight",label:"Ocean Freight"},{value:"rail freight",label:"Rail Freight"}];return e.jsx("div",{className:"flex h-screen flex-col",children:e.jsxs(fe,{breadcrumbs:be,children:[e.jsx(ne,{title:"Create PR"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 px-4",children:[e.jsxs("div",{className:"mt-2 flex w-full justify-end gap-4 rounded border bg-white px-6 py-4 shadow",children:[e.jsx("div",{className:"flex-1 justify-start",children:e.jsx("img",{src:i.user.bu_id==1?`${window.location.origin}/storage/suhay_logo.png`:i.user.bu_id==2?`${window.location.origin}/storage/alibata_logo.png`:"",alt:"",style:{width:"150px",objectFit:"contain"}})}),e.jsxs("div",{className:"max-w-sm flex-1",children:[e.jsx(r,{htmlFor:"pr_no",className:"mb-1 block font-bold text-gray-800",children:"PO No."}),e.jsx(o,{id:"pr_no",type:"text",name:"pr_no",className:"w-full rounded-sm shadow-none",value:b,placeholder:"--Auto Generated--",readOnly:!0})]}),e.jsxs("div",{className:"max-w-sm flex-1",children:[e.jsx(r,{htmlFor:"pr_no",className:"mb-1 block font-bold text-gray-800",children:"PR No."}),e.jsx(o,{id:"pr_no",type:"text",name:"pr_no",className:"w-full rounded-sm shadow-none",value:l.pr_no,placeholder:"--Auto Generated--",readOnly:!0})]})]}),e.jsx("div",{className:"rounded border bg-white p-4 shadow",children:e.jsxs("div",{className:"flex w-full gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{htmlFor:"bu_id",className:"mb-1 block font-bold text-gray-800",children:"Buyer:"}),e.jsx(o,{id:"bu_id",type:"text",name:"bu_id",className:"w-full rounded-sm shadow-none",value:`${i.user.fname} ${i.user.mname} ${i.user.lname}`,readOnly:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{htmlFor:"department_id",className:"mb-1 block font-bold text-gray-800",children:"Confirming To:"}),e.jsx(o,{id:"department_id",type:"text",name:"department_id",className:"w-full rounded-sm shadow-none",value:l.bu.name,readOnly:!0})]})]})}),e.jsxs("div",{className:"rounded border bg-white p-4 shadow",children:[e.jsxs("div",{className:"mb-4 flex w-full gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{htmlFor:"requestor_id",className:"mb-1 block font-bold text-gray-800",children:"Vendor Contact Person"}),e.jsx(o,{id:"requestor_id",type:"text",name:"requestor_id",className:"w-full rounded-sm shadow-none",value:h==null?void 0:h.contact_person,placeholder:"Name of Requestor",readOnly:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{htmlFor:"date_issue",className:"mb-1 block font-bold text-gray-800",children:"Vendor Email Address"}),e.jsx(o,{id:"requestor_id",type:"text",name:"requestor_id",className:"w-full rounded-sm shadow-none",value:u,readOnly:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{htmlFor:"date_needed",className:`mb-1 block font-bold text-gray-800 ${c.date_needed?"text-red-500":""}`,children:"Vendor Tel. No.:"}),e.jsx(o,{id:"requestor_id",type:"text",name:"requestor_id",className:"w-full rounded-sm shadow-none",value:W,readOnly:!0})]})]}),e.jsxs("div",{className:"flex w-full gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{htmlFor:"requestor_id",className:"mb-1 block font-bold text-gray-800",children:"Vendor Name"}),e.jsx(v,{id:"classification_id",placeholder:"Select Classification",isClearable:!0,options:O,value:O.find(s=>s.value===se)||null,onChange:s=>{te(s?s.value:void 0),X(s)}}),e.jsx(_,{className:"mt-2",value:h==null?void 0:h.address,readOnly:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{htmlFor:"requestor_id",className:"mb-1 mb-2 block font-bold text-gray-800",children:"Ship To"}),e.jsx(o,{className:"mb-2",value:l.bu.name}),e.jsx(_,{value:l.bu_id==1?"Paseo de Sta. Rosa, Greenfield City, Sta. Rosa, Laguna Philippines 4026":"",readOnly:!0})]})]})]}),e.jsxs("div",{className:"rounded border bg-white p-4 shadow",children:[e.jsxs("div",{className:"mt-4 flex w-full gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{htmlFor:"date_needed",className:`mb-1 block font-bold text-gray-800 ${c.date_needed?"text-red-500":""}`,children:"Ship Via:"}),e.jsx(v,{placeholder:"Select Shipping Method",isClearable:!0,options:$,value:$.find(s=>s.value===A)||null,onChange:s=>{Y(s==null?void 0:s.value),Z(s)}})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{htmlFor:"classification_id",className:`mb-1 block font-bold text-gray-800 ${c.classification_id?"text-red-500":""}`,children:"Freight:"}),e.jsx(v,{id:"ship_via",placeholder:"Select Shipping Method",isClearable:!0,options:L,value:L.find(s=>s.value===A)||null,onChange:s=>{setFreight(s==null?void 0:s.value),setFreightDetails(s)}})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{htmlFor:"date_needed",className:`mb-1 block font-bold text-gray-800 ${c.date_needed?"text-red-500":""}`,children:"Terms:"}),e.jsx(o,{id:"date_needed",type:"text",name:"date_needed",className:`w-full rounded-sm shadow-none ${c.date_needed?"border-red-500":""}`,value:y,onChange:s=>{I(s.target.value),j({...c,date_needed:!1})}})]})]}),e.jsxs("div",{className:"mt-4 flex-1",children:[e.jsx(r,{htmlFor:"remarks",className:"mb-1 block font-bold text-gray-800",children:"Remarks"}),e.jsx(_,{id:"remarks",name:"remarks",className:"rounded-sm shadow-none",value:R,placeholder:"Remarks",onChange:s=>{P(s.target.value)},readOnly:!0})]})]}),e.jsx("div",{className:"rounded bg-white shadow",children:e.jsx(je,{items:x,setItems:D,showAddRow:!0})}),e.jsx(ge,{itRelated:N}),e.jsx("div",{className:"flex flex-col items-center justify-center gap-4 p-4",children:e.jsx("div",{className:"flex flex-col gap-2 md:flex-row md:items-center",children:e.jsxs(ce,{children:[e.jsx(ue,{asChild:!0,children:e.jsxs(f,{type:"submit",disabled:!y||!k||!m,children:[e.jsx(le,{className:"mr-1 h-4 w-4"}),"Submit"]})}),e.jsxs(me,{className:"z-99999",children:[e.jsx(xe,{children:"Purchase Request"}),e.jsx(pe,{children:"Are you sure you want to proceed?"}),e.jsxs(he,{className:"gap-2",children:[e.jsx(B,{asChild:!0,children:e.jsx(f,{variant:"secondary",children:"Cancel"})}),e.jsx(B,{asChild:!0,children:e.jsx(f,{asChild:!0,children:e.jsx("button",{type:"submit",onClick:ee,children:p?"Please wait.":"Confirm"})})})]})]})]})})})]})]})})}export{Ee as default};
